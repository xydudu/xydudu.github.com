---
layout: default
title: 关于js文件加载的一些小思考
---

前端的性能，JS加载速度算是一个比较重要的指标了，一直在大牛们的文章之间游荡，希望能吸取一些为我所用，无奈大牛太多，这海太
大，各种文章，思想，越发让我无法下手，于是拨开一切，从零开始，一步一步来。

假定有三个JS文件：

*a.js* : 加载要 1 秒 (要依赖c.js)
var a = c && 'a';

*b.js* : 加载要 2 秒
var b = 'b';

*c.js* : 加载要 3 秒 
var c = 'c';

(**为了模拟加载的时间，三个文件都用php代替**)

传统的方法，按c,b,a顺序依次加载。

{%highlight html linenos%}
<script src="c.js"></script>
<script src="b.js"></script>
<script src="a.js"></script>
{%endhighlight%}

{%highlight javascript linenos%}
function print() {
    var info = document.getElementById("info");
    info.innerHTML += "<p>" + [].join.call(arguments) + "</p>";  		
}

print(a);
print(b);
print(c);
{%endhighlight%}


输出： a, b, c

其在IE6下的timeline：
!http://blog.xydudu.com/css/images/load-1.jpg!

可以看到，三个js文件依次单独加载，是串行的，整个时间花了差不多6秒。显然，这样是很让恼火的表现，如果三个文件能同时下载的
话，理论上只要3秒就能把三个文件下载完成了，这将节约一半的时间。

并行下载JS文件的loader现在已有很多表现很好的作品出现了，这里我用 "headjs":http://headjs.com 来演示JS并行下载的demo。

a, b, c三个文件还是那三个文件。只是这次用headjs来引入。
{%highlight javascript linenos%}
honey.js("c.php", "b.php", "a.php", function() {
    print(a);
    print(b);
    print(c);
});
{%endhighlight%}

还是正常输出： a, b, c

再来查看IE6下的timeline：
!http://blog.xydudu.com/css/images/load-test-2.jpg!

三个文件并行下载，总的时间减小到差不多3秒，这对页面的渲染速度提升是非常大的。




    
